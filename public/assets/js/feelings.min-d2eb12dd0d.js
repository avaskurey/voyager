"use strict";var FeelingComponent=React.createClass({displayName:"FeelingComponent",getInitialState:function(){return{data:[],loading:!1,submitting:0,rawData:null,voted:!1}},calculatedPercentage:function(){var e=this.state.rawData,t={};t.happy=0==e.happy?0:Math.round(e.happy/e.total*100),t.sad=0==e.sad?0:Math.round(e.sad/e.total*100),t.angry=0==e.angry?0:Math.round(e.angry/e.total*100),t.informative=0==e.informative?0:Math.round(e.informative/e.total*100),this.setState({data:t})},loadDataFromServer:function(){$.ajax({method:"GET",url:"/json/dhivehi/feeling/article/"+this.props.article_id,dataType:"json",success:function(e){this.setState({rawData:e}),this.calculatedPercentage()}.bind(this),error:function(e,t,a){}.bind(this)})},handleVote:function(e){var t=$(e.target).parents(".option").data("opt");if(t||(t=$(e.target).data("opt")),0==this.state.loading&&0==this.state.voted){var a;switch(t){case 1:a="happy";break;case 2:a="sad";break;case 3:a="angry";break;case 4:a="informative"}var s=this.state.rawData;s[a]++,s.total++,this.setState({rawData:s})}this.setState({loading:!0,submitting:t}),$.ajax({method:"POST",url:"/json/dhivehi/feeling/article/"+this.props.article_id,dataType:"json",data:{article_id:this.props.article_id,option:t,_token:$('meta[name="csrf-token"]').attr("content")},success:function(e){this.setState({loading:!1,submitting:0,voted:!0}),this.calculatedPercentage()}.bind(this),error:function(e,t,a){}.bind(this)})},componentDidMount:function(){this.loadDataFromServer()},render:function(){return React.createElement("div",{className:"col-md-10"},React.createElement("h3",{className:"variant-two"},"މިލިޔުން ކިޔާލުމުން"),React.createElement("div",{className:"feelings-container"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-3 col-xs-push-9"},React.createElement("div",{className:"feeling"},React.createElement("div",{className:"opt-details"},React.createElement("a",{className:"option",onClick:this.handleVote,"data-opt":"1"},React.createElement("span",{className:"icon"},React.createElement("img",{src:"/build/assets/images/smileys/happy.png"})),React.createElement("span",{className:"meta"},React.createElement("span",{className:"bubble",style:{display:this.state.loading&&1==this.state.submitting?"none":"inherit"}},this.state.data.happy," %"),React.createElement("div",{className:"loading",style:{display:this.state.loading&&1==this.state.submitting?"block":"none"}},React.createElement("i",{className:"fa fa-circle-o-notch fa-spin"}))),React.createElement("span",{className:"clearfix"}),React.createElement("span",{className:"title"},"އުފާވި"))))),React.createElement("div",{className:"col-xs-3 col-xs-push-3"},React.createElement("div",{className:"feeling"},React.createElement("div",{className:"opt-details"},React.createElement("a",{className:"option",onClick:this.handleVote,"data-opt":"2"},React.createElement("span",{className:"icon"},React.createElement("img",{src:"/build/assets/images/smileys/sad.png"})),React.createElement("span",{className:"meta"},React.createElement("span",{className:"bubble",style:{display:this.state.loading&&2==this.state.submitting?"none":"inherit"}},this.state.data.sad," %"),React.createElement("div",{className:"loading",style:{display:this.state.loading&&2==this.state.submitting?"block":"none"}},React.createElement("i",{className:"fa fa-circle-o-notch fa-spin"}))),React.createElement("span",{className:"clearfix"}),React.createElement("span",{className:"title"},"ދެރަވި"))))),React.createElement("div",{className:"col-xs-3 col-xs-pull-3"},React.createElement("div",{className:"feeling"},React.createElement("div",{className:"opt-details"},React.createElement("a",{className:"option",onClick:this.handleVote,"data-opt":"3"},React.createElement("span",{className:"icon"},React.createElement("img",{src:"/build/assets/images/smileys/angry.png"})),React.createElement("span",{className:"meta"},React.createElement("span",{className:"bubble",style:{display:this.state.loading&&3==this.state.submitting?"none":"inherit"}},this.state.data.angry," %"),React.createElement("div",{className:"loading",style:{display:this.state.loading&&3==this.state.submitting?"block":"none"}},React.createElement("i",{className:"fa fa-circle-o-notch fa-spin"}))),React.createElement("span",{className:"clearfix"}),React.createElement("span",{className:"title"},"ރުޅިއައި"))))),React.createElement("div",{className:"col-xs-3 col-xs-pull-9"},React.createElement("div",{className:"feeling"},React.createElement("div",{className:"opt-details"},React.createElement("a",{className:"option",onClick:this.handleVote,"data-opt":"4"},React.createElement("span",{className:"icon"},React.createElement("img",{src:"/build/assets/images/smileys/informative.png"})),React.createElement("span",{className:"meta"},React.createElement("span",{className:"bubble",style:{display:this.state.loading&&4==this.state.submitting?"none":"inherit"}},this.state.data.informative," %"),React.createElement("div",{className:"loading",style:{display:this.state.loading&&4==this.state.submitting?"block":"none"}},React.createElement("i",{className:"fa fa-circle-o-notch fa-spin"}))),React.createElement("span",{className:"clearfix"}),React.createElement("span",{className:"title"},"މައުލޫމާތު މުއްސަނދިވި"))))))))}});ReactDOM.render(React.createElement(FeelingComponent,{article_id:article_id}),document.getElementById("feelingRoot"));